{% extends "layout.html" %}

{% block title %}
    {{account.name}}
{% endblock %}
{% block platform %}
    {% if platform != None%}
        {{platform.name}}
    {%else%}
        set platform
    {% endif %}
{% endblock %}

{% block model %}
    {% if model%}
        @{{model.username}}
    {%else%}
       set model
    {% endif %}
{% endblock %}

    {%block main%}
            <div class="main-box">
                <div class="header">
                    <h1>Account details</h1>
                    <div class="action-links scroll">
                        <a href="/accounts" class="eleveted-a">
                            accounts
                        </a>
                        <a href="" class="eleveted-a delete Do-you-want-to-delete-this-account?">
                            delete this account
                        </a>
                        <a href="" class="eleveted-a upload-image">
                            add images
                        </a>
                    </div>
                </div>

                <div class="main-container">
                    {%if action != 'edit-account'%}
                    <div class="holder profile-holder scroll">
                        <div class="profile-card">
                            <div class="profile-image" class="item-header"  
                            style="background: url('{{account.profile_image}}');
                            background-repeat: no-repeat;
                            background-size: cover;
                            background-position:top">
                            </div>
                            <div class="profile-card-details">
                                <h4>
                                    {{account.name}}
                                </h4>
                                <div class="d-status">
                                    <p class="bg-success">Active</p>
                                    {% if account.status != 'VERIFIED' %}
                                        <p class="bg-danger">Not verified</p>
                                    {%else%}
                                    <p class="bg-success">Not verified</p>
                                    {%endif%}

                                    <p class="bg-warning">
                                            {% if account.matches < 1%}
                                            not matched
                                            {%else%}
                                            matched
                                            {%endif%}
                                    </p>
                                </div>
                                <div class="d-items">
                                    <p>
                                        {{account.matches}} matches
                                    </p>
                                    <p>
                                        {{account.swipes}} liked
                                    </p>
                                    <p>
                                        {{account.likes}} likes
                                    </p>
                                    <p>
                                        {{account.messages}} messages
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="profile-details">
                            {%if action == 'map'%}
                                <div id="op-map" class="map p-details-actions"></div>
                                <input type="hidden" name="op-location" id="op-location" value="" data-account-id="{{account.id}}"/>
                                <div class="p-details-actions">
                                    <a  href="/account-page?account={{account.id}}&action=edit-account" class="edit-account">
                                        Edit account
                                    </a>
                                    <a href="/account-page?account={{account.id}}" class="upload-account-image">
                                        Account details
                                    </a>
                                    <a href="" class="eleveted-a" id="updateButton">
                                        Update location
                                    </a>
                                </div>
                            {%else%}
                                <ul class="p-details-items">
                                    <li>
                                        <i class="fa fa-envelope"></i>
                                        {{account.email}}
                                    </li>
                                    {%if account.phone%}
                                        <li>
                                            <i class="fas fa-phone-square"></i>
                                            +1{{account.phone.number}}
                                        </li>
                                    {%endif%}
                                    <li>
                                        <i class="fa fa-venus-mars"></i>
                                        {%if account.gender|lower in ['f','female']%}
                                            Female
                                        {%else%}
                                            Male
                                        {%endif%}
                                    </li>
                                    <li style="display: none;">

                                    </li>
                                </ul>
                                <div class="p-details-bio">
                                    <div class="p-details-bio-item">
                                        <i class="fa fa-map-marker"></i> &nbsp;
                                        {{account.city}}, {{account.country_code}}
                                    </div>
                                    <a href="/account-page?account={{account.id}}&action=map" class="">map</a>
                                </div>
                                    
                                <div class="p-details-bio">
                                    <div class="p-details-bio-item bio-desc scroll">
                                        {{account.profile.bio}}
                                    </div>
                                </div>
                                {%if account.images%}
                                    <ul class="p-details-images" id="profile-images">
                                        {%for image in account.images%}
                                        <li>
                                            <img src="{{image}}" class="clickable-image" accountId="{{account.id}}" alt="">
                                        </li>
                                        {%endfor%}
                                        
                                        <span>
                                            <a href="" class="view-all">
                                                view all
                                            </a>
                                        </span>
                                    </ul>
                                {%endif%}
                                <div class="p-details-actions">
                                    <a href="" class="delete Do-you-want-to-delete-this-account?">
                                        Delete account
                                    </a>
                                    <a href="" class="upload-account-image">
                                        Add images
                                    </a>
                                    <a href="/account-page?account={{account.id}}&action=edit-account" class="edit-account">
                                        Edit Account
                                    </a>
                                    <a href="" class="view-matches m">
                                    View matches
                                    </a>
                                    <a href="" class="view-matches l">
                                        View likes
                                    </a>
                                    <a href="" class="view-matches lm">
                                        View liked me
                                    </a>
                                </div>
                            {%endif%}
                        </div>
                    </div>
                    {%else%}
                    <div class="holder scroll form-holder">
                        <h2>
                            Edit-Account
                        </h2>
                        
                        <form action="" class="op-form edit-account" id="account-form" 
                            data-action="edit-account" data-action-message="Updating account details">
                            <div>
                                <label for="bio">Biography</label>
                                <input type="text" name="bio" id="bio" value="{{account.profile.bio}}">
                            </div>
                            <input type="hidden" id="account-id" name="account-id" value="{{account.id}}">
                            <div>
                                <label for="height">Height</label>
                                <input type="number" name="height" id="height" 
                                    value="{%if account.profile.height != ''%}{{account.profile.height}}{%else%}91{%endif%}" 
                                    min="91" max="220">
                                <h5 class="input-highlight"> 
                                    <i class="fas fas fa-exclamation-circle"></i> 
                                    must be between 91 - 220. e.g 91
                                </h5>
                            </div>
                            {% for key, options in edit_data.items() %}
                                <div>
                                    <label for="{{ key }}">{{ key|capitalize }}:</label>
                                    <select name="{{key}}" id="{{ key }}">
                                        {%if account.profile[key] != ''%}
                                            <option value="{{account.profile[key]}}">{{account.profile[key]}}</option>
                                        {%endif%}
                                        {% for option in options %}
                                        <option value="{{ option }}">{{ option }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            {% endfor %}
                            <input type="submit" name="Submit">
                        </form>
                    </div>
                    {%endif%}
                </div>
            </div>
        <style>
            .p-details-bio {
            display: flex;
            align-items: left;
            justify-content: space-between;
            }

            .p-details-bio > div{
                flex: 70%;
                margin: auto;
            }

            .p-details-bio > a{
                width: fit-content;
                text-align: right;
                font-weight: 500;
                background: #fdf3cd;
                border-radius: 10px;
                padding: 2.5px 10px;
                margin: auto;
            }

            .bio-input {
                flex-grow: 1;
                margin-right: 10px;
            }

            .text-style {
                border: none;
                background-color: transparent;
                padding: 0;
                font-size: inherit;
                font-family: inherit;
                color: inherit;
                outline: none;
            }  
            .map{
                height: 70%;
            }
            
            #updateButton{
                background: var(--secondary);
            }
            
        </style>
        {%if matches%}
            <script>
                const _matches ='{{matches | tojson | safe}}';
            </script>
        {%endif%}
    {%endblock%}