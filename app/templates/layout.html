{% extends "includes.html"%}
{%block content%}
    <section class="navbar">
        <div class="user-card">
            <div class="details">
                <h5>
                    {{ g.admin.full_name }}
                </h5>
                <span>
                    {{g.admin.email}}
                </span>
                <span>
                    <i class="fa fa-caret-down"></i>
                </span>
                <div class="user-card-action">
                    <div class="">
                        <h6>{{g.admin.full_name}}</h6>
                        {{g.admin.email}}
                    </div>
                    <a href="/logout?admin={{g.admin.id}}" class="eleveted-a logout-btn">
                        <i class="fas fa-sign-out"></i>
                        Logout
                    </a>
                </div>
            </div>
            <div class="user-image">
                <p class="image">
                    {%if g.admin.full_name != None%}
                        {% set name_parts = g.admin.full_name.split() %}
                        {% if name_parts|length > 1 %}
                            {{ name_parts[0][0] }}{{ name_parts[1][0] }} 
                        {% else %}
                            {{ name_parts[0][0] }}
                        {% endif %}
                    {%endif%}
                </p>
            </div>
            <span class="close-menu-btn">
                <i class="fa fa-close"></i>
            </span>
        </div>
        <nav>
            <form action="#">
                <span>
                    <i class="fa fa-search"></i>
                </span>
                <input type="search" placeholder="Search...">
            </form>
            <ul>
                <li>
                    <!-- <span>10+</span>
                    <i class="fa fa-bell"></i> -->
                </li>
                <li class="model-tag">
                    {% if g.model %}
                        {{g.model.full_name}}
                    {%else%}
                        set model
                    {%endif%}
                 </li>
                <li class="platform-tag">
                    {% if g.platform %}
                        {{g.platform.name}}
                    {%else%}
                        set platform
                    {%endif%}
                </li>
                <li>
                    <a href="/admins?action=admin-settings&admin={{g.admin.id}}">
                        <i class="fa fa-cog"></i>
                    </a>
                </li>
                <li class="menu-btn" id="menu-btn">
                    <i class="fas fa-bars"></i>
                </li>
            </ul>
        </nav>
    </section>
    <section class="main">
        <div class="sidebar">
            <ul class="links platforms">
                <li>platforms</li>
                <li class="{% if g.page == 'platforms' %}active{% endif %}">
                    <a href="/platforms">
                        <i class="fa-brands fa-app-store"></i>
                        Platforms
                    </a>
                </li>
                <li class="{% if g.page == 'add-platforms' %}active{% endif %}">
                    <a href="/platforms?action=add-platform">
                        <i class="fas fa-plus-circle"></i>
                        Add platforms
                    </a>
                </li>
            </ul>
            <ul class="links models">
                <li>models</li>
                <li class="{% if g.page == 'models' %}active{% endif %}">
                    <a href="/models">
                        <i class="fas fa-user-friends"></i>
                        Models
                    </a>
                </li>
                <li class="{% if g.page == 'add-model' %}active{% endif %}">
                    <a href="/models?action=add-model">
                        <i class="fa fa-user-plus"></i>
                        Add model
                    </a>
                </li>
            </ul>
            <ul class="links services">
                <li>actions</li>
                <li  class="{% if g.page in ['accounts','account-page'] %}active{% endif %}">
                    <a href="/accounts">
                        <i class="fas fa-user-friends"></i>
                        Accounts
                    </a>
                </li>
                <li class="{% if g.page == 'create-accounts' %}active{% endif %}">
                    <a href="/create-accounts">
                        <i class="fa fa-user-plus"></i>
                        Create accounts
                    </a>
                </li>
                <li class="{% if g.page == 'swipes' %}active{% endif %}">
                    <a href="/swipe">
                        <i class="fas fa-hand-point-up"></i>
                        &nbsp; Swipe
                    </a>
                </li>
                <li class="{% if g.page == 'send-msg' %}active{% endif %}">
                    <a href="/send-msg">
                        <i class="fa fa-paper-plane"></i>
                        Send messages
                    </a>
                </li>
                 <li class="{% if g.page == 'images' %}active{% endif %}">
                    <a href="/images/profile">
                        <i class="fas fa-folder-open"></i>
                        Images
                    </a>
                </li>
                <li class="{% if g.page == 'account-configs' %}active{% endif %}">
                    <a href="/account-configs">
                        <i class="fas fa-cogs"></i>
                        Configs
                    </a>
                </li>
                <li class="{% if g.page == 'tasks' %}active{% endif %}">
                    <a href="/tasks">
                        <i class="fas fa-tasks"></i>
                       Tasks
                    </a>
                </li>
                <!-- <li class="{% if g.page == 'schedules' %}active{% endif %}">
                    <a href="/schedules">
                        <i class="fas fa-clock"></i>
                      Schedule tasks
                    </a>
                </li> -->
            </ul>
            <ul class="links user">
                <li>user</li>
                {%if g.admin.role != 'admin'%}
                <li class="{% if g.page == 'admins' %}active{% endif %}"">
                    <i class="fas fa-user-friends"></i>
                    <a href="/admins">
                        Users 
                    </a>
                </li>
                {%endif%}
                <li class="{% if g.page == 'settings' %}active{% endif %}">
                    <i class="fa fa-cog"></i>
                    <a href="/admins?action=admin-settings&admin={{g.admin.id}}">
                        Settings
                    </a>
                </li>
                {% if g.admin %}
                <li class="">
                    <i class="fas fa-sign-out"></i>
                    <a href="#" class="logout-btn">
                        Logout
                    </a>
                </li>
                {%endif%}
            </ul>
        </div>
        {%block main%}{% endblock%}
    </section>
    <div class="overlay">
    </div>
    <div class="modal-holder">
    </div>

    {%if g.page in ['schedules','create-accounts','account-page']%}
        {%if g.page != 'account-page'%}
            <style>
                .map{
                    position: absolute;
                    bottom: 80%;
                    left: -100px;
                    width: 300px;
                    height: 200px;
                    border: 10px solid var(--soft-white);
            }
        
            .map.show{
                display: block;
            }
        
            .map.no-show{
                display: none;
            }
        
            .double-field > .inputs > .map-btn > #toggle-map{
                margin: 20px auto;
                padding: 5px 16px;
                background: var(--soft-white);
                color: #333;
                border-radius: 20px;
        
            }
        
            @media screen  and (max-width:768.99px){
                .map{
                    left: 0;
                    /* bottom: 0;
                    top: 90%; */
                    width: 100%;
                }
        
                .double-field > .inputs > .map-btn > #toggle-map{
                    margin: 5px auto;
                }
            }
            </style>
       {%endif%}
       <script src="https://maps.googleapis.com/maps/api/js?key=" + gcloudkey + "&callback=initMap" defer></script>
        <script>
        function initMap() {
            const usaBounds = new google.maps.LatLngBounds(
                new google.maps.LatLng(24.396308, -125.000000), // Southwest corner
                new google.maps.LatLng(49.384358, -66.934570) // Northeast corner
            );

            const map = new google.maps.Map(document.getElementById("op-map"), {
                zoom: 4,
                center: { lat: 39.8283, lng: -98.5795 },
                restriction: {
                    latLngBounds: usaBounds,
                    strictBounds: true
                }
            });

            // Create the initial InfoWindow.
            let infoWindow = new google.maps.InfoWindow({
                content: "Click the map to get Lat/Lng!",
                position: { lat: 39.8283, lng: -98.5795 }
            });

            infoWindow.open(map);

            // Configure the click listener.
            map.addListener("click", (mapsMouseEvent) => {
                // Close the current InfoWindow.
                infoWindow.close();

                // Create a new InfoWindow.
                const latLng = mapsMouseEvent.latLng;
                const latitude = latLng.lat();
                const longitude = latLng.lng();

                // Update the value of the input field.
                document.getElementById("op-location").value = `${latitude}, ${longitude}`;

                infoWindow = new google.maps.InfoWindow({
                    position: mapsMouseEvent.latLng
                });

                infoWindow.setContent(JSON.stringify(mapsMouseEvent.latLng.toJSON(), null, 2));
                infoWindow.open(map);
            });
        }

        window.initMap = initMap;
        </script>

       
    {%endif%}
{% endblock%}